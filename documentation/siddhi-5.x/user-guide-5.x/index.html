



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Cloud Native Stream Processor">
      
      
        <link rel="canonical" href="http://siddhi.io/documentation/siddhi-5.x/user-guide-5.x/">
      
      
        <meta name="author" content="WSO2">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.0">
    
    
      
        <title>User Guide - Siddhi</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.982221ab.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="#009688">
      
    
    
      <script src="../../../assets/javascripts/modernizr.1f0bcf2b.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-103065-28", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="teal" data-md-color-accent="teal">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#siddhi-5x-user-guide" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="http://siddhi.io" title="Siddhi" class="md-header-nav__button md-logo">
          
            <img src="../../../images/siddhi-logo-w.svg" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Siddhi
            </span>
            <span class="md-header-nav__topic">
              User Guide
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/siddhi-io/siddhi/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Siddhi
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="http://siddhi.io" title="Siddhi" class="md-nav__button md-logo">
      
        <img src="../../../images/siddhi-logo-w.svg" width="48" height="48">
      
    </a>
    Siddhi
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/siddhi-io/siddhi/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Siddhi
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Welcome to Siddhi" class="md-nav__link">
      Welcome to Siddhi
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../quckstart-5.x/" title="Quick Start Guide" class="md-nav__link">
      Quick Start Guide
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../download/" title="Download" class="md-nav__link">
      Download
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      Documentation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Documentation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-1" type="checkbox" id="nav-5-1" checked>
    
    <label class="md-nav__link" for="nav-5-1">
      Siddhi 5.x
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-1">
        Siddhi 5.x
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../quckstart-5.x/" title="Quick Start Guide" class="md-nav__link">
      Quick Start Guide
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        User Guide
      </label>
    
    <a href="./" title="User Guide" class="md-nav__link md-nav__link--active">
      User Guide
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#system-requirements" title="System Requirements" class="md-nav__link">
    System Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-siddhi-in-various-environments" title="Using Siddhi in various environments" class="md-nav__link">
    Using Siddhi in various environments
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-siddhi-as-a-java-library" title="Using Siddhi as a Java library" class="md-nav__link">
    Using Siddhi as a Java library
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-siddhi-as-local-micro-service" title="Using Siddhi as Local Micro Service" class="md-nav__link">
    Using Siddhi as Local Micro Service
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#running-siddhi-app" title="Running Siddhi App" class="md-nav__link">
    Running Siddhi App
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-with-runner-config" title="Running with runner config" class="md-nav__link">
    Running with runner config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-with-environmentalsystem-variables" title="Running with environmental/system variables" class="md-nav__link">
    Running with environmental/system variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-siddhi-as-docker-micro-service" title="Using Siddhi as Docker Micro Service" class="md-nav__link">
    Using Siddhi as Docker Micro Service
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#running-siddhi-app_1" title="Running Siddhi App" class="md-nav__link">
    Running Siddhi App
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-with-runner-config_1" title="Running with runner config" class="md-nav__link">
    Running with runner config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-with-environmentalsystem-variables_1" title="Running with environmental/system variables" class="md-nav__link">
    Running with environmental/system variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-siddhi-as-kubernetes-micro-service" title="Using Siddhi as Kubernetes Micro Service" class="md-nav__link">
    Using Siddhi as Kubernetes Micro Service
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites" title="Prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-siddhi-operator" title="Install Siddhi Operator" class="md-nav__link">
    Install Siddhi Operator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-and-run-siddhi-app" title="Deploy and Run Siddhi App" class="md-nav__link">
    Deploy and Run Siddhi App
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-siddhi-process-status" title="Get Siddhi process status" class="md-nav__link">
    Get Siddhi process status
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-siddhi-processes" title="List Siddhi processes" class="md-nav__link">
    List Siddhi processes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#view-siddhi-process-configs" title="View Siddhi process configs" class="md-nav__link">
    View Siddhi process configs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#view-siddhi-process-logs" title="View Siddhi process logs" class="md-nav__link">
    View Siddhi process logs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-and-run-siddhi-app-using-config-maps" title="Deploy and Run Siddhi App using config maps" class="md-nav__link">
    Deploy and Run Siddhi App using config maps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-siddhi-apps-without-ingress-creation" title="Deploy Siddhi Apps without ingress creation" class="md-nav__link">
    Deploy Siddhi Apps without ingress creation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-and-run-siddhi-app-with-https" title="Deploy and Run Siddhi App with HTTPS" class="md-nav__link">
    Deploy and Run Siddhi App with HTTPS
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-siddhi-as-a-python-library" title="Using Siddhi as a Python Library" class="md-nav__link">
    Using Siddhi as a Python Library
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../config-guide-5.x/" title="Config Guide" class="md-nav__link">
      Config Guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../query-guide-5.x/" title="Siddhi Query Guide" class="md-nav__link">
      Siddhi Query Guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../architecture-5.x/" title="Siddhi Architecture" class="md-nav__link">
      Siddhi Architecture
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-2" type="checkbox" id="nav-5-2">
    
    <label class="md-nav__link" for="nav-5-2">
      Siddhi 4.x
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-2">
        Siddhi 4.x
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../siddhi-4.x/quckstart-4.x/" title="Quick Start Guide" class="md-nav__link">
      Quick Start Guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../siddhi-4.x/user-guide-4.x/" title="User Guide" class="md-nav__link">
      User Guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../siddhi-4.x/query-guide-4.x/" title="Siddhi Query Guide" class="md-nav__link">
      Siddhi Query Guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../siddhi-4.x/architecture-4.x/" title="Siddhi Architecture" class="md-nav__link">
      Siddhi Architecture
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../contribution/" title="Contribute" class="md-nav__link">
      Contribute
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../extensions/" title="Extensions" class="md-nav__link">
      Extensions
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      API Docs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        API Docs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../api/5.0.0/" title="5.0.0" class="md-nav__link">
      5.0.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../api/4.4.8/" title="4.4.8" class="md-nav__link">
      4.4.8
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../api/4.4.0/" title="4.4.0" class="md-nav__link">
      4.4.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../api/4.3.19/" title="4.3.19" class="md-nav__link">
      4.3.19
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../api/4.3.0/" title="4.3.0" class="md-nav__link">
      4.3.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../api/4.2.40/" title="4.2.40" class="md-nav__link">
      4.2.40
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../api/4.2.20/" title="4.2.20" class="md-nav__link">
      4.2.20
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../api/4.2.0/" title="4.2.0" class="md-nav__link">
      4.2.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../api/4.1.64/" title="4.1.64" class="md-nav__link">
      4.1.64
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../api/4.1.46/" title="4.1.46" class="md-nav__link">
      4.1.46
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../api/4.1.7/" title="4.1.7" class="md-nav__link">
      4.1.7
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../api/4.1.0/" title="4.1.0" class="md-nav__link">
      4.1.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../api/4.0.9/" title="4.0.9" class="md-nav__link">
      4.0.9
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../api/4.0.0/" title="4.0.0" class="md-nav__link">
      4.0.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../api/latest/" title="latest" class="md-nav__link">
      latest
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../season-of-docs-2019/" title="Google Season of Code 2019" class="md-nav__link">
      Google Season of Code 2019
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#system-requirements" title="System Requirements" class="md-nav__link">
    System Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-siddhi-in-various-environments" title="Using Siddhi in various environments" class="md-nav__link">
    Using Siddhi in various environments
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-siddhi-as-a-java-library" title="Using Siddhi as a Java library" class="md-nav__link">
    Using Siddhi as a Java library
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-siddhi-as-local-micro-service" title="Using Siddhi as Local Micro Service" class="md-nav__link">
    Using Siddhi as Local Micro Service
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#running-siddhi-app" title="Running Siddhi App" class="md-nav__link">
    Running Siddhi App
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-with-runner-config" title="Running with runner config" class="md-nav__link">
    Running with runner config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-with-environmentalsystem-variables" title="Running with environmental/system variables" class="md-nav__link">
    Running with environmental/system variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-siddhi-as-docker-micro-service" title="Using Siddhi as Docker Micro Service" class="md-nav__link">
    Using Siddhi as Docker Micro Service
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#running-siddhi-app_1" title="Running Siddhi App" class="md-nav__link">
    Running Siddhi App
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-with-runner-config_1" title="Running with runner config" class="md-nav__link">
    Running with runner config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-with-environmentalsystem-variables_1" title="Running with environmental/system variables" class="md-nav__link">
    Running with environmental/system variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-siddhi-as-kubernetes-micro-service" title="Using Siddhi as Kubernetes Micro Service" class="md-nav__link">
    Using Siddhi as Kubernetes Micro Service
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites" title="Prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-siddhi-operator" title="Install Siddhi Operator" class="md-nav__link">
    Install Siddhi Operator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-and-run-siddhi-app" title="Deploy and Run Siddhi App" class="md-nav__link">
    Deploy and Run Siddhi App
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-siddhi-process-status" title="Get Siddhi process status" class="md-nav__link">
    Get Siddhi process status
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-siddhi-processes" title="List Siddhi processes" class="md-nav__link">
    List Siddhi processes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#view-siddhi-process-configs" title="View Siddhi process configs" class="md-nav__link">
    View Siddhi process configs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#view-siddhi-process-logs" title="View Siddhi process logs" class="md-nav__link">
    View Siddhi process logs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-and-run-siddhi-app-using-config-maps" title="Deploy and Run Siddhi App using config maps" class="md-nav__link">
    Deploy and Run Siddhi App using config maps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-siddhi-apps-without-ingress-creation" title="Deploy Siddhi Apps without ingress creation" class="md-nav__link">
    Deploy Siddhi Apps without ingress creation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-and-run-siddhi-app-with-https" title="Deploy and Run Siddhi App with HTTPS" class="md-nav__link">
    Deploy and Run Siddhi App with HTTPS
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-siddhi-as-a-python-library" title="Using Siddhi as a Python Library" class="md-nav__link">
    Using Siddhi as a Python Library
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/siddhi-io/siddhi/edit/master/docs/documentation/siddhi-5.x/user-guide-5.x.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="siddhi-5x-user-guide">Siddhi 5.x User Guide<a class="headerlink" href="#siddhi-5x-user-guide" title="Permanent link">&para;</a></h1>
<h2 id="system-requirements">System Requirements<a class="headerlink" href="#system-requirements" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Memory</strong>   - 128 MB (minimum), 500 MB (recommended), higher memory might be needed based on in-memory data stored for processing</li>
<li><strong>Cores</strong>    - 2 cores (recommended), use lower number of cores after testing Siddhi Apps for performance</li>
<li><strong>JDK</strong>      - 8 or 11</li>
<li>To build Siddhi from the Source distribution, it is necessary that you have JDK version 8 or 11 and Maven 3.0.4 or later</li>
</ol>
<h2 id="using-siddhi-in-various-environments">Using Siddhi in various environments<a class="headerlink" href="#using-siddhi-in-various-environments" title="Permanent link">&para;</a></h2>
<h3 id="using-siddhi-as-a-java-library"><strong>Using Siddhi as a Java library</strong><a class="headerlink" href="#using-siddhi-as-a-java-library" title="Permanent link">&para;</a></h3>
<p>Siddhi can be used as a library in any Java program (including OSGi runtimes) just by adding Siddhi and its extension jars as dependencies.</p>
<ul>
<li>
<p>Find a sample Siddhi project that's implemented as a Java program using Maven <a href="https://github.com/suhothayan/siddhi-sample">here</a>, this can be used as a reference for any based implementation.</p>
</li>
<li>
<p>Following are the mandatory dependencies that need to be added to the Maven <code>pom.xml</code> file (or to the class path).</p>
</li>
</ul>
<div class="codehilite"><pre><span></span>   <span class="nt">&lt;dependency&gt;</span>
     <span class="nt">&lt;groupId&gt;</span>io.siddhi<span class="nt">&lt;/groupId&gt;</span>
     <span class="nt">&lt;artifactId&gt;</span>siddhi-core<span class="nt">&lt;/artifactId&gt;</span>
     <span class="nt">&lt;version&gt;</span>5.x.x<span class="nt">&lt;/version&gt;</span>
   <span class="nt">&lt;/dependency&gt;</span>
   <span class="nt">&lt;dependency&gt;</span>
     <span class="nt">&lt;groupId&gt;</span>io.siddhi<span class="nt">&lt;/groupId&gt;</span>
     <span class="nt">&lt;artifactId&gt;</span>siddhi-query-api<span class="nt">&lt;/artifactId&gt;</span>
     <span class="nt">&lt;version&gt;</span>5.x.x<span class="nt">&lt;/version&gt;</span>
   <span class="nt">&lt;/dependency&gt;</span>
   <span class="nt">&lt;dependency&gt;</span>
     <span class="nt">&lt;groupId&gt;</span>io.siddhi<span class="nt">&lt;/groupId&gt;</span>
     <span class="nt">&lt;artifactId&gt;</span>siddhi-query-compiler<span class="nt">&lt;/artifactId&gt;</span>
     <span class="nt">&lt;version&gt;</span>5.x.x<span class="nt">&lt;/version&gt;</span>
   <span class="nt">&lt;/dependency&gt;</span>
   <span class="nt">&lt;dependency&gt;</span>
     <span class="nt">&lt;groupId&gt;</span>io.siddhi<span class="nt">&lt;/groupId&gt;</span>
     <span class="nt">&lt;artifactId&gt;</span>siddhi-annotations<span class="nt">&lt;/artifactId&gt;</span>
     <span class="nt">&lt;version&gt;</span>5.x.x<span class="nt">&lt;/version&gt;</span>
   <span class="nt">&lt;/dependency&gt;</span>   
</pre></div>


<ul>
<li>Sample Java class using Siddhi is as follows.</li>
</ul>
<script src="https://gist.github.com/suhothayan/0c81a843101601e82a7175b7add2aa4d.js"></script>

<h3 id="using-siddhi-as-local-micro-service"><strong>Using Siddhi as Local Micro Service</strong><a class="headerlink" href="#using-siddhi-as-local-micro-service" title="Permanent link">&para;</a></h3>
<p>Siddhi can also run a standalone program by passing the SiddhiApps and required configurations to it.</p>
<ul>
<li>Download the latest <a href="https://github.com/siddhi-io/distribution/releases/download/v0.1.0/siddhi-runner-0.1.0.zip">Siddhi Runner distribution</a> </li>
<li>Unzip the siddhi-runner-x.x.x.zip</li>
<li>Start SiddhiApps with the runner config by executing the following commands from the distribution directory<br/>
  Linux/Mac : <code>./bin/runner.sh -Dapps=&lt;siddhi-file&gt; -Dconfig=&lt;config-yaml-file&gt;</code><br/>
  Windows : <code>bin\runner.bat -Dapps=&lt;siddhi-file&gt; -Dconfig=&lt;config-yaml-file&gt;</code></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Running Multiple SiddhiApps in one runner.</p>
<p>To run multiple SiddhiApps in one runtime, have all SiddhiApps in a directory and pass its location through <code>-Dapps</code> parameter as follows,<br/>
<code>-Dapps=&lt;siddhi-apps-directory&gt;</code></p>
</div>
<div class="admonition note">
<p class="admonition-title">Always use <strong>absolute path</strong> for SiddhiApps and runner configs.</p>
<p>Providing absolute path of SiddhiApp file, or directory in <code>-Dapps</code> parameter, and when providing the Siddhi runner config yaml on <code>-Dconfig</code> parameter while starting Siddhi runner.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Siddhi Tooling</p>
<p>You can also use the powerful <a href="https://siddhi-io.github.io/siddhi/documentation/siddhi-5.x/quckstart-5.x/#3-using-siddhi-for-the-first-time">Siddhi Editor</a> to implement and test steam processing applications. </p>
</div>
<p><strong>Samples</strong></p>
<h4 id="running-siddhi-app">Running Siddhi App<a class="headerlink" href="#running-siddhi-app" title="Permanent link">&para;</a></h4>
<p>Following SiddhiApp collects events via HTTP and logs the number of events arrived during last 15 seconds.  </p>
<script src="https://gist.github.com/suhothayan/8b0471cbe86a0089db5d6afb1c46f765.js"></script>

<ul>
    <li>Copy the above SiddhiApp, and create the SiddhiApp file <code>CountOverTime.siddhi</code>.</li>
    <li>Run the SiddhiApp by executing following commands from the distribution directory
        <ul>
            <li>Linux/Mac :
            <pre style="white-space:pre-wrap;">./bin/runner.sh -Dapps=&lt;absolute-siddhi-file-path&gt;/CountOverTime.siddhi</pre>
            </li>
            <li>Windows :
            <pre style="white-space:pre-wrap;">bin\runner.bat -Dapps=&lt;absolute-siddhi-file-path&gt;\CountOverTime.siddhi</pre>
            </li>
        </ul>
    </li>
    <li>Test the SiddhiApp by calling the HTTP endpoint using curl or Postman as follows
        <ul>
            <li><b>Publish events with curl command:</b><br/>
            Publish few json to the http endpoint as follows,
<pre style="white-space:pre-wrap;">
curl -X POST http://localhost:8006/production \
  --header "Content-Type:application/json" \
  -d '{"event":{"name":"Cake","amount":20.12}}'
</pre>
            </li>
            <li><b>Publish events with Postman:</b>
              <ol>
                <li>Install 'Postman' application from Chrome web store</li>
                <li>Launch the application</li>
                <li>Make a 'Post' request to 'http://localhost:8006/production' endpoint. Set the Content-Type to <code>'application/json'</code> and set the request body in json format as follows,
<pre>
{
  "event": {
    "name": "Cake",
    "amount": 20.12
  }
}</pre>
                </li>
              </ol>
            </li>
        </ul>
    </li>
    <li>Runner logs the total count on the console. Note, how the count increments with every event sent.
<pre style="white-space:pre-wrap;">
[2019-04-11 13:36:03,517]  INFO {io.siddhi.core.stream.output.sink.LogSink} - CountOverTime : TotalCountStream : Event{timestamp=1554969963512, data=[1], isExpired=false}
[2019-04-11 13:36:10,267]  INFO {io.siddhi.core.stream.output.sink.LogSink} - CountOverTime : TotalCountStream : Event{timestamp=1554969970267, data=[2], isExpired=false}
[2019-04-11 13:36:41,694]  INFO {io.siddhi.core.stream.output.sink.LogSink} - CountOverTime : TotalCountStream : Event{timestamp=1554970001694, data=[1], isExpired=false}
</pre>
    </li>
</ul>

<h4 id="running-with-runner-config">Running with runner config<a class="headerlink" href="#running-with-runner-config" title="Permanent link">&para;</a></h4>
<p>When running SiddhiApps users can optionally provide a config yaml to Siddhi runner to manage configurations such as state persistence, databases connections and secure vault.</p>
<p>Following SiddhiApp collects events via HTTP and store them in H2 Database.</p>
<script src="https://gist.github.com/suhothayan/2413a6f886219befe736bf4447af02de.js"></script>

<p>The runner config can by configured with the relevant datasource information and passed when starting the runner</p>
<script src="https://gist.github.com/suhothayan/015ae003d4ba8d4aeaadc19e4c9516fd.js"></script>

<ul>
    <li>Copy the above SiddhiApp, & config yaml, and create corresponding the SiddhiApp file <code>ConsumeAndStore.siddhi</code> and <code>TestDb.yaml</code> files.</li>
    <li>Run the SiddhiApp by executing following commands from the distribution directory
        <ul>
            <li>Linux/Mac :
            <pre style="white-space:pre-wrap;">./bin/runner.sh -Dapps=&lt;absolute-siddhi-file-path&gt;/ConsumeAndStore.siddhi \
  -Dconfig=&lt;absolute-config-yaml-path&gt;/TestDb.yaml</pre>
            </li>
            <li>Windows :
            <pre style="white-space:pre-wrap;">bin\runner.sh -Dapps=&lt;absolute-siddhi-file-path&gt;\ConsumeAndStore.siddhi ^
  -Dconfig=&lt;absolute-config-yaml-path&gt;\TestDb.yaml</pre>
            </li>
        </ul>
    </li>
    <li>Test the SiddhiApp by calling the HTTP endpoint using curl or Postman as follows
        <ul>
            <li><b>Publish events with curl command:</b><br/>
            Publish few json to the http endpoint as follows,
<pre style="white-space:pre-wrap;">
curl -X POST http://localhost:8006/production \
  --header "Content-Type:application/json" \
  -d '{"event":{"name":"Cake","amount":20.12}}'
</pre>
            </li>
            <li><b>Publish events with Postman:</b>
              <ol>
                <li>Install 'Postman' application from Chrome web store</li>
                <li>Launch the application</li>
                <li>Make a 'Post' request to 'http://localhost:8006/production' endpoint. Set the Content-Type to <code>'application/json'</code> and set the request body in json format as follows,
<pre>
{
  "event": {
    "name": "Cake",
    "amount": 20.12
  }
}</pre>
                </li>
              </ol>
            </li>
        </ul>
    </li>
    <li>Query Siddhi Store APIs to retrieve 10 records from the table.
        <ul>
            <li><b>Query stored events with curl command:</b><br/>
            Publish few json to the http endpoint as follows,
<pre style="white-space:pre-wrap;">
curl -X POST https://localhost:9443/stores/query \
  -H "content-type: application/json" \
  -u "admin:admin" \
  -d '{"appName" : "ConsumeAndStore", "query" : "from ProductionTable select * limit 10;" }' -k
</pre>
            </li>
            <li><b>Query stored events with Postman:</b>
              <ol>
                <li>Install 'Postman' application from Chrome web store</li>
                <li>Launch the application</li>
                <li>Make a 'Post' request to 'https://localhost:9443/stores/query' endpoint. Set the Content-Type to <code>'application/json'</code> and set the request body in json format as follows,
<pre>
{
  "appName" : "ConsumeAndStore",
  "query" : "from ProductionTable select * limit 10;"
}</pre>
                </li>
              </ol>
            </li>
        </ul>
    </li>
    <li>The results of the query will be as follows,
<pre style="white-space:pre-wrap;">
{
  "records":[
    ["Cake",20.12]
  ]
}</pre>
    </li>
</ul>

<h4 id="running-with-environmentalsystem-variables">Running with environmental/system variables<a class="headerlink" href="#running-with-environmentalsystem-variables" title="Permanent link">&para;</a></h4>
<p>Templating SiddhiApps allows users to provide environment/system variables to siddhiApps at runtime. This can help users to migrate SiddhiApps from one environment to another (E.g from dev, test and to prod).</p>
<p>Following templated SiddhiApp collects events via HTTP, filters them based on <code>amount</code> greater than a given threshold value, and only sends the filtered events via email.</p>
<p>Here the <code>THRESHOLD</code> value, and <code>TO_EMAIL</code> are templated in the <code>TemplatedFilterAndEmail.siddhi</code> SiddhiApp.</p>
<script src="https://gist.github.com/suhothayan/47b6300f629463e63b2d5be78d6e45b4.js"></script>

<p>The runner config is configured with a gmail account to send email messages in <code>EmailConfig.yaml</code> by templating sending <code>EMAIL_ADDRESS</code>, <code>EMAIL_USERNAME</code> and <code>EMAIL_PASSWORD</code>.   </p>
<script src="https://gist.github.com/suhothayan/3f36f8827d379925a8cca68dd78b9a8e.js"></script>

<ul>
    <li>Copy the above SiddhiApp, & config yaml, and create corresponding the SiddhiApp file <code>TemplatedFilterAndEmail.siddhi</code> and <code>EmailConfig.yaml</code> files.</li>

    <li>Set environment variables by running following in the termial Siddhi is about to run: 
         <pre style="white-space:pre-wrap;">
export THRESHOLD=20
export TO_EMAIL=&lt;to email address&gt; 
export EMAIL_ADDRESS=&lt;gmail address&gt;
export EMAIL_USERNAME=&lt;gmail username&gt;
export EMAIL_PASSWORD=&lt;gmail password&gt;</pre>
        Or they can also be passed as system variables by adding 
        <pre style="white-space:pre-wrap;">-DTHRESHOLD=20 -DTO_EMAIL=&gt;to email address&gt; -DEMAIL_ADDRESS=&lt;gmail address&gt; 
 -DEMAIL_USERNAME=&lt;gmail username&gt; -DEMAIL_PASSWORD=&lt;gmail password&gt;</pre>
        to the end of the runner startup script.
    </li>
        <li>Run the SiddhiApp by executing following commands from the distribution directory
        <ul>
            <li>Linux/Mac :
            <pre style="white-space:pre-wrap;">
./bin/runner.sh -Dapps=&lt;absolute-file-path&gt;/TemplatedFilterAndEmail.siddhi \
  -Dconfig=&lt;absolute-config-yaml-path&gt;/EmailConfig.yaml</pre>
            </li>
            <li>Windows :
            <pre style="white-space:pre-wrap;">
bin\runner.bat -Dapps=&lt;absolute-file-path&gt;\TemplatedFilterAndEmail.siddhi ^
  -Dconfig=&lt;absolute-config-yaml-path&gt;\EmailConfig.yaml</pre>
            </li>
        </ul>
    </li>
    <li>Test the SiddhiApp by calling the HTTP endpoint using curl or Postman as follows
        <ul>
            <li><b>Publish events with curl command:</b><br/>
            Publish few json to the http endpoint as follows,
<pre style="white-space:pre-wrap;">
curl -X POST http://localhost:8006/production \
  --header "Content-Type:application/json" \
  -d '{"event":{"name":"Cake","amount":2000.0}}'
</pre>
            </li>
            <li><b>Publish events with Postman:</b>
              <ol>
                <li>Install 'Postman' application from Chrome web store</li>
                <li>Launch the application</li>
                <li>Make a 'Post' request to 'http://localhost:8006/production' endpoint. Set the Content-Type to <code>'application/json'</code> and set the request body in json format as follows,
<pre>
{
  "event": {
    "name": "Cake",
    "amount": 2000.0
  }
}</pre>
                </li>
              </ol>
            </li>
        </ul>
    </li>
    <li>Check the <code>to.email</code> for the published email message, which will look as follows,
<pre style="white-space:pre-wrap;">
Subject : High Cake production!

Hi, 

High production of Cake, with amount 2000.0 identified. 

For more information please contact production department. 

Thank you</pre>
    </li>
</ul>

<h3 id="using-siddhi-as-docker-micro-service"><strong>Using Siddhi as Docker Micro Service</strong><a class="headerlink" href="#using-siddhi-as-docker-micro-service" title="Permanent link">&para;</a></h3>
<p>Siddhi can also run on Docker by passing the SiddhiApps and required configurations to it.</p>
<ul>
<li>Pull the the latest Siddhi Runner image from <a href="https://hub.docker.com/">Docker Hub</a>.</li>
</ul>
<div class="codehilite"><pre><span></span>docker pull siddhiio/siddhi-runner-alpine:latest
</pre></div>


<ul>
<li>Start SiddhiApps with the runner config by executing the following docker command.<br/></li>
</ul>
<div class="codehilite"><pre><span></span>docker run -it -v &lt;local-siddhi-file-path&gt;:&lt;siddhi-file-mount-path&gt; -v &lt;local-conf-file-path&gt;:&lt;conf-file-mount-path&gt; siddhiio/siddhi-runner-alpine:latest -Dapps=&lt;siddhi-file-mount-path&gt; -Dconfig=&lt;conf-file-mount-path&gt;
</pre></div>


<p>E.g.,</p>
<div class="codehilite"><pre><span></span>docker run -it -v /home/me/siddhi-apps:/apps -v /home/me/siddhi-configs:/configs siddhiio/siddhi-runner-alpine:latest -Dapps=/apps/Foo.siddhi -Dconfig=/configs/siddhi-config.yaml
</pre></div>


<div class="admonition tip">
<p class="admonition-title">Running multiple SiddhiApps in one runner instance.</p>
<p>To run multiple SiddhiApps in one runtime instance, have all SiddhiApps in a directory, mount the directory and pass its location through <code>-Dapps</code> parameter as follows,<br/>
<code>-Dapps=&lt;siddhi-apps-directory&gt;</code></p>
</div>
<div class="admonition note">
<p class="admonition-title">Always use <strong>absolute path</strong> for SiddhiApps and runner configs.</p>
<p>Providing absolute path of SiddhiApp file, or directory in <code>-Dapps</code> parameter, and when providing the Siddhi runner config yaml on <code>-Dconfig</code> parameter while starting Siddhi runner.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Siddhi Tooling</p>
<p>You can also use the powerful <a href="https://siddhi-io.github.io/siddhi/documentation/siddhi-5.x/quckstart-5.x/#3-using-siddhi-for-the-first-time">Siddhi Editor</a> to implement and test steam processing applications. </p>
</div>
<p><strong>Samples</strong></p>
<h4 id="running-siddhi-app_1">Running Siddhi App<a class="headerlink" href="#running-siddhi-app_1" title="Permanent link">&para;</a></h4>
<p>Following SiddhiApp collects events via HTTP and logs the number of events arrived during last 15 seconds.  </p>
<script src="https://gist.github.com/suhothayan/8b0471cbe86a0089db5d6afb1c46f765.js"></script>

<ul>
    <li>Copy the above SiddhiApp, and create the SiddhiApp file <code>CountOverTime.siddhi</code>.</li>
    <li>Run the SiddhiApp by executing following commands from the distribution directory
        <ul>
            <li>
            <pre style="white-space:pre-wrap;">docker run -it -p 8006:8006 -v &lt;local-absolute-siddhi-file-path&gt;/CountOverTime.siddhi:/apps/CountOverTime.siddhi siddhiio/siddhi-runner-alpine -Dapps=/apps/CountOverTime.siddhi
</pre>
            </li>
        </ul>
    </li>
    <li>Test the SiddhiApp by calling the HTTP endpoint using curl or Postman as follows
        <ul>
            <li><b>Publish events with curl command:</b><br/>
            Publish few json to the http endpoint as follows,
<pre style="white-space:pre-wrap;">
curl -X POST http://localhost:8006/production \
  --header "Content-Type:application/json" \
  -d '{"event":{"name":"Cake","amount":20.12}}'
</pre>
            </li>
            <li><b>Publish events with Postman:</b>
              <ol>
                <li>Install 'Postman' application from Chrome web store</li>
                <li>Launch the application</li>
                <li>Make a 'Post' request to 'http://localhost:8006/production' endpoint. Set the Content-Type to <code>'application/json'</code> and set the request body in json format as follows,
<pre>
{
  "event": {
    "name": "Cake",
    "amount": 20.12
  }
}</pre>
                </li>
              </ol>
            </li>
        </ul>
    </li>
    <li>Runner logs the total count on the console. Note, how the count increments with every event sent.
<pre style="white-space:pre-wrap;">
[2019-04-11 13:36:03,517]  INFO {io.siddhi.core.stream.output.sink.LogSink} - CountOverTime : TotalCountStream : Event{timestamp=1554969963512, data=[1], isExpired=false}
[2019-04-11 13:36:10,267]  INFO {io.siddhi.core.stream.output.sink.LogSink} - CountOverTime : TotalCountStream : Event{timestamp=1554969970267, data=[2], isExpired=false}
[2019-04-11 13:36:41,694]  INFO {io.siddhi.core.stream.output.sink.LogSink} - CountOverTime : TotalCountStream : Event{timestamp=1554970001694, data=[1], isExpired=false}
</pre>
    </li>
</ul>

<h4 id="running-with-runner-config_1">Running with runner config<a class="headerlink" href="#running-with-runner-config_1" title="Permanent link">&para;</a></h4>
<p>When running SiddhiApps users can optionally provide a config yaml to Siddhi runner to manage configurations such as state persistence, databases connections and secure vault.</p>
<p>Following SiddhiApp collects events via HTTP and store them in H2 Database.</p>
<script src="https://gist.github.com/suhothayan/2413a6f886219befe736bf4447af02de.js"></script>

<p>The runner config can be configured with the relevant datasource information and passed when starting the runner</p>
<script src="https://gist.github.com/suhothayan/015ae003d4ba8d4aeaadc19e4c9516fd.js"></script>

<ul>
    <li>Copy the above SiddhiApp, & config yaml, and create corresponding the SiddhiApp file <code>ConsumeAndStore.siddhi</code> and <code>TestDb.yaml</code> files.</li>
    <li>Run the SiddhiApp by executing following command
        <ul>
            <li>
             <pre style="white-space:pre-wrap;">docker run -it -p 8006:8006 -p 9443:9443 -v &lt;local-absolute-siddhi-file-path&gt;/ConsumeAndStore.siddhi:/apps/ConsumeAndStore.siddhi -v &lt;local-absolute-config-yaml-path&gt;/TestDb.yaml:/conf/TestDb.yaml siddhiio/siddhi-runner-alpine -Dapps=/apps/ConsumeAndStore.siddhi -Dconfig=/conf/TestDb.yaml</pre>
            </li>
        </ul>
    </li>
    <li>Test the SiddhiApp by calling the HTTP endpoint using curl or Postman as follows
        <ul>
            <li><b>Publish events with curl command:</b><br/>
            Publish few json to the http endpoint as follows,
<pre style="white-space:pre-wrap;">
curl -X POST http://localhost:8006/production \
  --header "Content-Type:application/json" \
  -d '{"event":{"name":"Cake","amount":20.12}}'
</pre>
            </li>
            <li><b>Publish events with Postman:</b>
              <ol>
                <li>Install 'Postman' application from Chrome web store</li>
                <li>Launch the application</li>
                <li>Make a 'Post' request to 'http://localhost:8006/production' endpoint. Set the Content-Type to <code>'application/json'</code> and set the request body in json format as follows,
<pre>
{
  "event": {
    "name": "Cake",
    "amount": 20.12
  }
}</pre>
                </li>
              </ol>
            </li>
        </ul>
    </li>
    <li>Query Siddhi Store APIs to retrieve 10 records from the table.
        <ul>
            <li><b>Query stored events with curl command:</b><br/>
            Publish few json to the http endpoint as follows,
<pre style="white-space:pre-wrap;">
curl -X POST https://localhost:9443/stores/query \
  -H "content-type: application/json" \
  -u "admin:admin" \
  -d '{"appName" : "ConsumeAndStore", "query" : "from ProductionTable select * limit 10;" }' -k
</pre>
            </li>
            <li><b>Query stored events with Postman:</b>
              <ol>
                <li>Install 'Postman' application from Chrome web store</li>
                <li>Launch the application</li>
                <li>Make a 'Post' request to 'https://localhost:9443/stores/query' endpoint. Set the Content-Type to <code>'application/json'</code> and set the request body in json format as follows,
<pre>
{
  "appName" : "ConsumeAndStore",
  "query" : "from ProductionTable select * limit 10;"
}</pre>
                </li>
              </ol>
            </li>
        </ul>
    </li>
    <li>The results of the query will be as follows,
<pre style="white-space:pre-wrap;">
{
  "records":[
    ["Cake",20.12]
  ]
}</pre>
    </li>
</ul>

<h4 id="running-with-environmentalsystem-variables_1">Running with environmental/system variables<a class="headerlink" href="#running-with-environmentalsystem-variables_1" title="Permanent link">&para;</a></h4>
<p>Templating SiddhiApps allows users to provide environment/system variables to siddhiApps at runtime. This can help users to migrate SiddhiApps from one environment to another (E.g from dev, test and to prod).</p>
<p>Following templated SiddhiApp collects events via HTTP, filters them based on <code>amount</code> greater than a given threshold value, and only sends the filtered events via email.</p>
<p>Here the <code>THRESHOLD</code> value, and <code>TO_EMAIL</code> are templated in the <code>TemplatedFilterAndEmail.siddhi</code> SiddhiApp.</p>
<script src="https://gist.github.com/suhothayan/47b6300f629463e63b2d5be78d6e45b4.js"></script>

<p>The runner config is configured with a gmail account to send email messages in <code>EmailConfig.yaml</code> by templating sending <code>EMAIL_ADDRESS</code>, <code>EMAIL_USERNAME</code> and <code>EMAIL_PASSWORD</code>.   </p>
<script src="https://gist.github.com/suhothayan/3f36f8827d379925a8cca68dd78b9a8e.js"></script>

<ul>
    <li>Copy the above SiddhiApp, & config yaml, and create corresponding the SiddhiApp file <code>TemplatedFilterAndEmail.siddhi</code> and <code>EmailConfig.yaml</code> files.</li>

    <li>Set the below environment variables by passing them during the docker run command: 
         <pre style="white-space:pre-wrap;">
 THRESHOLD=20
 TO_EMAIL=&lt;to email address&gt; 
 EMAIL_ADDRESS=&lt;gmail address&gt;
 EMAIL_USERNAME=&lt;gmail username&gt;
 EMAIL_PASSWORD=&lt;gmail password&gt;</pre>
        Or they can also be passed as system variables by adding them to the end of the docker run command .
        <pre style="white-space:pre-wrap;">-DTHRESHOLD=20 -DTO_EMAIL=&gt;to email address&gt; -DEMAIL_ADDRESS=&lt;gmail address&gt; 
 -DEMAIL_USERNAME=&lt;gmail username&gt; -DEMAIL_PASSWORD=&lt;gmail password&gt;</pre>

    </li>
        <li>Run the SiddhiApp by executing following command.
        <ul>
            <li>
            <pre style="white-space:pre-wrap;">docker run -it -p 8006:8006 -v &lt;local-absolute-siddhi-file-path&gt;/TemplatedFilterAndEmail.siddhi:/apps/TemplatedFilterAndEmail.siddhi -v &lt;local-absolute-config-yaml-path&gt;/EmailConfig.yaml:/conf/EmailConfig.yaml -e THRESHOLD=20 -e TO_EMAIL=&lt;to email address&gt; -e EMAIL_ADDRESS=&lt;gmail address&gt; -e EMAIL_USERNAME=&lt;gmail username&gt; -e EMAIL_PASSWORD=&lt;gmail password&gt; siddhiio/siddhi-runner-alpine -Dapps=/apps/TemplatedFilterAndEmail.siddhi -Dconfig=/conf/EmailConfig.yaml </pre>

            </li>
        </ul>
    </li>
    <li>Test the SiddhiApp by calling the HTTP endpoint using curl or Postman as follows
        <ul>
            <li><b>Publish events with curl command:</b><br/>
            Publish few json to the http endpoint as follows,
<pre style="white-space:pre-wrap;">
curl -X POST http://localhost:8006/production \
  --header "Content-Type:application/json" \
  -d '{"event":{"name":"Cake","amount":2000.0}}'
</pre>
            </li>
            <li><b>Publish events with Postman:</b>
              <ol>
                <li>Install 'Postman' application from Chrome web store</li>
                <li>Launch the application</li>
                <li>Make a 'Post' request to 'http://localhost:8006/production' endpoint. Set the Content-Type to <code>'application/json'</code> and set the request body in json format as follows,
<pre>
{
  "event": {
    "name": "Cake",
    "amount": 2000.0
  }
}</pre>
                </li>
              </ol>
            </li>
        </ul>
    </li>
    <li>Check the <code>to.email</code> for the published email message, which will look as follows,
<pre style="white-space:pre-wrap;">
Subject : High Cake production!

Hi, 

High production of Cake, with amount 2000.0 identified. 

For more information please contact production department. 

Thank you</pre>
    </li>
</ul>

<h3 id="using-siddhi-as-kubernetes-micro-service"><strong>Using Siddhi as Kubernetes Micro Service</strong><a class="headerlink" href="#using-siddhi-as-kubernetes-micro-service" title="Permanent link">&para;</a></h3>
<p>Siddhi can natively run on Kubernetes using the Siddhi Kubernetes operator.</p>
<h4 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>A Kubernetes cluster v1.11.8 or higher.</p>
<ol>
<li><a href="https://github.com/kubernetes/minikube#installation">Minikube</a></li>
<li><a href="https://console.cloud.google.com/">Google Kubernetes Engine(GKE) Cluster</a></li>
<li>Or any other Kubernetes cluster</li>
</ol>
</li>
<li>
<p>Admin privileges to install Siddhi operator  </p>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Minikube</p>
<p>For Siddhi operator automatically creates NGINX ingress. Therefore it to work we can either enable ingress on Minikube using the following command.
<pre>
minikube addons enable ingress
</pre>
or disable Siddhi operator's <a href="#deploy-siddhi-apps-without-ingress-creation">automatically ingress creation</a>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Google Kubernetes Engine (GKE) Cluster</p>
<p>To install Siddhi operator, you have to give cluster admin permission to your account. In order to do that execute the following command (by replacing "your-address@email.com" with your account email address). 
<pre>kubectl create clusterrolebinding user-cluster-admin-binding \ 
        --clusterrole=cluster-admin --user=your-address@email.com
</pre>  </p>
</div>
<h4 id="install-siddhi-operator">Install Siddhi Operator<a class="headerlink" href="#install-siddhi-operator" title="Permanent link">&para;</a></h4>
<p>To install the Siddhi Kubernetes operator run the following commands.</p>
<div class="codehilite"><pre><span></span>kubectl apply -f https://github.com/siddhi-io/siddhi-operator/releases/download/v0.1.0/prerequisites.yaml
kubectl apply -f https://github.com/siddhi-io/siddhi-operator/releases/download/v0.1.0/siddhi-operator.yaml
</pre></div>


<p>You can verify the installation by making sure the following deployments are running in your Kubernetes cluster. </p>
<div class="codehilite"><pre><span></span>$ kubectl get deployment

NAME              DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
siddhi-operator   1         1         1            1           1m
siddhi-parser     1         1         1            1           1m
</pre></div>


<h4 id="deploy-and-run-siddhi-app">Deploy and Run Siddhi App<a class="headerlink" href="#deploy-and-run-siddhi-app" title="Permanent link">&para;</a></h4>
<p>Siddhi applications can be deployed on Kubernetes using the Siddhi operator. </p>
<p>Here we will creating a very simple Siddhi stream processing application that consumes events via HTTP, filers the input events on the type 'monitored' and logs the output on the console.
This can be created using a SiddhiProcess YAML file as given below.</p>
<script src="https://gist.github.com/BuddhiWathsala/f029d671f4f6d7719dce59500b970815.js"></script>

<div class="admonition tip">
<p class="admonition-title">Siddhi Tooling</p>
<p>You can also use the powerful <a href="https://siddhi-io.github.io/siddhi/documentation/siddhi-5.x/quckstart-5.x/#3-using-siddhi-for-the-first-time">Siddhi Editor</a> to implement and test steam processing applications. </p>
</div>
<p>To deploy the above Siddhi app in your Kubernetes cluster, copy to a YAML file with name <code>monitor-app.yaml</code> and execute the following command.</p>
<div class="codehilite"><pre><span></span>kubectl create -f &lt;absolute-yaml-file-path&gt;/monitor-app.yaml
</pre></div>


<div class="admonition note">
<p class="admonition-title">tls secret</p>
<p>Within the SiddhiProcess, a tls secret named <code>siddhi-tls</code> is configured. If a Kubernetes secret with the same name does not exist in the Kubernetes cluster, the NGINX will ignore it and use a self-generated certificate. Configuring a secret will be necessary for calling HTTPS endpoints, refer <a href="#deploy-and-run-siddhi-app-with-https">deploy and run Siddhi apps with HTTPS</a> section for more details. </p>
</div>
<p>If the <code>monitor-app</code> is deployed successfully, the created SiddhiProcess, deployment, service, and ingress can be viewed as follows.</p>
<div class="codehilite"><pre><span></span>$ kubectl get SiddhiProcesses
NAME          AGE
monitor-app   2m

$ kubectl get deployment
NAME              DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
monitor-app       1         1         1            1           1m
siddhi-operator   1         1         1            1           1m
siddhi-parser     1         1         1            1           1m

$ kubectl get service
NAME              TYPE           CLUSTER-IP       EXTERNAL-IP   PORT(S)          AGE
kubernetes        ClusterIP      10.96.0.1        &lt;none&gt;        443/TCP          10d
monitor-app       ClusterIP      10.101.242.132   &lt;none&gt;        8280/TCP         1m
siddhi-operator   ClusterIP      10.111.138.250   &lt;none&gt;        8383/TCP         1m
siddhi-parser     LoadBalancer   10.102.172.142   &lt;pending&gt;     9090:31830/TCP   1m

$ kubectl get ingress
NAME      HOSTS     ADDRESS     PORTS     AGE
siddhi    siddhi    10.0.2.15   80, 443   1m
</pre></div>


<p><em>Invoke Siddhi Applications</em></p>
<p>To invoke the Siddhi App, first obtain the external IP of the ingress load balancer using <code>kubectl get ingress</code> command as follows.</p>
<div class="codehilite"><pre><span></span>$ kubectl get ingress
NAME      HOSTS     ADDRESS     PORTS     AGE
siddhi    siddhi    10.0.2.15   80, 443   1m
</pre></div>


<p>Then, add the host <code>siddhi</code> and related external IP (<code>ADDRESS</code>) to the <code>/etc/hosts</code> file in your machine.</p>
<div class="admonition note">
<p class="admonition-title">Minikube</p>
<p>For Minikube, you have to use Minikube IP as the external IP. Hence, run <code>minikube ip</code> command to get the IP of the Minikube cluster.</p>
</div>
<p>Use the following CURL command to send events to <code>monitor-app</code> deployed in Kubernetes.</p>
<div class="codehilite"><pre><span></span>curl -X POST \
  https://siddhi/monitor-app/8280/example \
  -H &#39;Content-Type: application/json&#39; \
  -d &#39;{
    &quot;type&quot;: &quot;monitored&quot;,
    &quot;deviceID&quot;: &quot;001&quot;,
    &quot;power&quot;: 341
  }&#39; -k
</pre></div>


<p><em>Note: Here <code>-k</code> option is used to turn off curl's verification of the certificate.</em> </p>
<p><em>View Siddhi Process Logs</em></p>
<p>Since the output of <code>monitor-app</code> is logged, you can see the output by monitoring the associated pod's logs. </p>
<p>To find the <code>monitor-app</code> pod use the <code>kubectl get pods</code> command. This will list down all the deployed pods. </p>
<div class="codehilite"><pre><span></span>$ kubectl get pods

NAME                               READY     STATUS    RESTARTS   AGE
monitor-app-7f8584875f-krz6t       1/1       Running   0          2m
siddhi-operator-8589c4fc69-6xbtx   1/1       Running   0          2m
siddhi-parser-64d4cd86ff-pfq2s     1/1       Running   0          2m
</pre></div>


<p>Here, the pod starting with the SiddhiProcess name (in this case <code>monitor-app-</code>) is the pod we need to monitor.</p>
<p>To view the logs, run the <code>kubectl logs &lt;pod name&gt;</code> command. 
This will show all the Siddhi process logs, along with the filtered output events as given below.</p>
<div class="codehilite"><pre><span></span>$ kubectl logs monitor-app-7f8584875f-krz6t
[2019-04-20 04:04:02,216]  INFO {org.wso2.extension.siddhi.io.http.source.HttpSourceListener} - Event input has paused for http://0.0.0.0:8280/example
[2019-04-20 04:04:02,235]  INFO {org.wso2.extension.siddhi.io.http.source.HttpSourceListener} - Event input has resume for http://0.0.0.0:8280/example
[2019-04-20 04:05:29,741]  INFO {io.siddhi.core.stream.output.sink.LogSink} - LOGGER : Event{timestamp=1555733129736, data=[monitored, 001, 341], isExpired=false}
</pre></div>


<h4 id="get-siddhi-process-status">Get Siddhi process status<a class="headerlink" href="#get-siddhi-process-status" title="Permanent link">&para;</a></h4>
<h5 id="list-siddhi-processes">List Siddhi processes<a class="headerlink" href="#list-siddhi-processes" title="Permanent link">&para;</a></h5>
<p>List the Siddhi process using the <code>kubectl get sps</code> or <code>kubectl get SiddhiProcesses</code> commands as follows.</p>
<div class="codehilite"><pre><span></span>$ kubectl get sps
NAME          AGE
monitor-app   2m

$ kubectl get SiddhiProcesses
NAME          AGE
monitor-app   2m
</pre></div>


<h5 id="view-siddhi-process-configs">View Siddhi process configs<a class="headerlink" href="#view-siddhi-process-configs" title="Permanent link">&para;</a></h5>
<p>Get the Siddhi process configuration details using <code>kubectl describe sp</code> command as follows.</p>
<div class="codehilite"><pre><span></span>$ kubectl describe sp monitor-app

Name:         monitor-app
Namespace:    default
Labels:       &lt;none&gt;
Annotations:  &lt;none&gt;
API Version:  siddhi.io/v1alpha1
Kind:         SiddhiProcess
Metadata:
  Creation Timestamp:  2019-04-18T18:05:39Z
  Generation:          1
  Resource Version:    497702
  Self Link:           /apis/siddhi.io/v1alpha1/namespaces/default/siddhiprocesses/monitor-app
  UID:                 92b2293b-6204-11e9-996c-0800279e6dba
Spec:
  Env:
    Name:   RECEIVER_URL
    Value:  http://0.0.0.0:8280/example
    Name:   BASIC_AUTH_ENABLED
    Value:  false
  Pod:
    Image:      siddhiio/siddhi-runner-alpine
    Image Tag:  0.1.0
  Query:        @App:name(&quot;MonitorApp&quot;)
@App:description(&quot;Description of the plan&quot;) 

@sink(type=&#39;log&#39;, prefix=&#39;LOGGER&#39;)
@source(type=&#39;http&#39;, receiver.url=&#39;${RECEIVER_URL}&#39;, basic.auth.enabled=&#39;${BASIC_AUTH_ENABLED}&#39;, @map(type=&#39;json&#39;))
define stream DevicePowerStream (type string, deviceID string, power int);


define stream MonitorDevicesPowerStream(deviceID string, power int);

@info(name=&#39;monitored-filter&#39;)
from DevicePowerStream[type == &#39;monitored&#39;]
select deviceID, power
insert into MonitorDevicesPowerStream;

  Siddhi . Runner . Configs:  state.persistence:
  enabled: true
  intervalInMin: 5
  revisionsToKeep: 2
  persistenceStore: io.siddhi.distribution.core.persistence.FileSystemPersistenceStore
  config:
    location: siddhi-app-persistence

Status:
  Nodes:   &lt;nil&gt;
  Status:  Running
Events:    &lt;none&gt;
</pre></div>


<p>Get the Siddhi process YAML using <code>kubectl get sp</code> command as follows.</p>
<div class="codehilite"><pre><span></span>$ kubectl get sp monitor-app -o yaml

apiVersion: siddhi.io/v1alpha1
kind: SiddhiProcess
metadata:
  creationTimestamp: 2019-04-18T18:05:39Z
  generation: 1
  name: monitor-app
  namespace: default
  resourceVersion: &quot;497702&quot;
  selfLink: /apis/siddhi.io/v1alpha1/namespaces/default/siddhiprocesses/monitor-app
  uid: 92b2293b-6204-11e9-996c-0800279e6dba
spec:
  env:
  - name: RECEIVER_URL
    value: http://0.0.0.0:8280/example
  - name: BASIC_AUTH_ENABLED
    value: &quot;false&quot;
  pod:
    image: siddhiio/siddhi-runner-alpine
    imageTag: 0.1.0
  query: &quot;@App:name(\&quot;MonitorApp\&quot;)\n@App:description(\&quot;Description of the plan\&quot;)
    \n\n@sink(type=&#39;log&#39;, prefix=&#39;LOGGER&#39;)\n@source(type=&#39;http&#39;, receiver.url=&#39;${RECEIVER_URL}&#39;,
    basic.auth.enabled=&#39;${BASIC_AUTH_ENABLED}&#39;, @map(type=&#39;json&#39;))\ndefine stream
    DevicePowerStream (type string, deviceID string, power int);\n\n\ndefine stream
    MonitorDevicesPowerStream(deviceID string, power int);\n\n@info(name=&#39;monitored-filter&#39;)\nfrom
    DevicePowerStream[type == &#39;monitored&#39;]\nselect deviceID, power\ninsert into MonitorDevicesPowerStream;\n&quot;
  siddhi.runner.configs: |
    state.persistence:
      enabled: true
      intervalInMin: 5
      revisionsToKeep: 2
      persistenceStore: io.siddhi.distribution.core.persistence.FileSystemPersistenceStore
      config:
        location: siddhi-app-persistence
status:
  nodes: null
  status: Running
</pre></div>


<h5 id="view-siddhi-process-logs">View Siddhi process logs<a class="headerlink" href="#view-siddhi-process-logs" title="Permanent link">&para;</a></h5>
<p>To view the Siddhi process logs, first get the Siddhi process pods using the <code>kubectl get pods</code> command as follows.  </p>
<div class="codehilite"><pre><span></span>$ kubectl get pods

NAME                               READY     STATUS    RESTARTS   AGE
monitor-app-7f8584875f-krz6t       1/1       Running   0          2m
siddhi-operator-8589c4fc69-6xbtx   1/1       Running   0          2m
siddhi-parser-64d4cd86ff-pfq2s     1/1       Running   0          2m
</pre></div>


<p>Then to retrieve the Siddhi process logs, run <code>kubectl logs &lt;pod name&gt;</code> command. Here <code>&lt;pod name&gt;</code> should be replaced with the name of the pod that starts with the relevant SiddhiProcess's name. 
A sample output logs is of this command is as follows.</p>
<div class="codehilite"><pre><span></span>$ kubectl logs monitor-app-7f8584875f-krz6t
JAVA_HOME environment variable is set to /opt/java/openjdk
CARBON_HOME environment variable is set to /home/siddhi_user/siddhi-runner-0.1.0
RUNTIME_HOME environment variable is set to /home/siddhi_user/siddhi-runner-0.1.0/wso2/runner
Picked up JAVA_TOOL_OPTIONS: -XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap
[2019-04-20 3:58:57,734]  INFO {org.wso2.carbon.launcher.extensions.OSGiLibBundleDeployerUtils updateOSGiLib} - Successfully updated the OSGi bundle information of Carbon Runtime: runner  
osgi&gt; [2019-04-20 03:59:00,208]  INFO {org.wso2.carbon.config.reader.ConfigFileReader} - Default deployment configuration updated with provided custom configuration file monitor-app-deployment.yaml
[2019-04-20 03:59:01,551]  INFO {org.wso2.msf4j.internal.websocket.WebSocketServerSC} - All required capabilities are available of WebSocket service component is available.
[2019-04-20 03:59:01,584]  INFO {org.wso2.carbon.metrics.core.config.model.JmxReporterConfig} - Creating JMX reporter for Metrics with domain &#39;org.wso2.carbon.metrics&#39;
[2019-04-20 03:59:01,609]  INFO {org.wso2.msf4j.analytics.metrics.MetricsComponent} - Metrics Component is activated
[2019-04-20 03:59:01,614]  INFO {org.wso2.carbon.databridge.agent.internal.DataAgentDS} - Successfully deployed Agent Server 
[2019-04-20 03:59:02,219]  INFO {io.siddhi.distribution.core.internal.ServiceComponent} - Periodic state persistence started with an interval of 5 using io.siddhi.distribution.core.persistence.FileSystemPersistenceStore
[2019-04-20 03:59:02,229]  INFO {io.siddhi.distribution.event.simulator.core.service.CSVFileDeployer} - CSV file deployer initiated.
[2019-04-20 03:59:02,233]  INFO {io.siddhi.distribution.event.simulator.core.service.SimulationConfigDeployer} - Simulation config deployer initiated.
[2019-04-20 03:59:02,279]  INFO {org.wso2.carbon.databridge.receiver.binary.internal.BinaryDataReceiverServiceComponent} - org.wso2.carbon.databridge.receiver.binary.internal.Service Component is activated
[2019-04-20 03:59:02,312]  INFO {org.wso2.carbon.databridge.receiver.binary.internal.BinaryDataReceiver} - Started Binary SSL Transport on port : 9712
[2019-04-20 03:59:02,321]  INFO {org.wso2.carbon.databridge.receiver.binary.internal.BinaryDataReceiver} - Started Binary TCP Transport on port : 9612
[2019-04-20 03:59:02,322]  INFO {org.wso2.carbon.databridge.receiver.thrift.internal.ThriftDataReceiverDS} - Service Component is activated
[2019-04-20 03:59:02,344]  INFO {org.wso2.carbon.databridge.receiver.thrift.ThriftDataReceiver} - Thrift Server started at 0.0.0.0
[2019-04-20 03:59:02,356]  INFO {org.wso2.carbon.databridge.receiver.thrift.ThriftDataReceiver} - Thrift SSL port : 7711
[2019-04-20 03:59:02,363]  INFO {org.wso2.carbon.databridge.receiver.thrift.ThriftDataReceiver} - Thrift port : 7611
[2019-04-20 03:59:02,449]  INFO {org.wso2.msf4j.internal.MicroservicesServerSC} - All microservices are available
[2019-04-20 03:59:02,516]  INFO {org.wso2.transport.http.netty.contractimpl.listener.ServerConnectorBootstrap$HttpServerConnector} - HTTP(S) Interface starting on host 0.0.0.0 and port 9090
[2019-04-20 03:59:02,520]  INFO {org.wso2.transport.http.netty.contractimpl.listener.ServerConnectorBootstrap$HttpServerConnector} - HTTP(S) Interface starting on host 0.0.0.0 and port 9443
[2019-04-20 03:59:03,068]  INFO {io.siddhi.distribution.core.internal.StreamProcessorService} - Periodic State persistence enabled. Restoring last persisted state of MonitorApp
[2019-04-20 03:59:03,075]  INFO {org.wso2.transport.http.netty.contractimpl.listener.ServerConnectorBootstrap$HttpServerConnector} - HTTP(S) Interface starting on host 0.0.0.0 and port 8280
[2019-04-20 03:59:03,077]  INFO {org.wso2.extension.siddhi.io.http.source.HttpConnectorPortBindingListener} - HTTP source 0.0.0.0:8280 has been started
[2019-04-20 03:59:03,084]  INFO {io.siddhi.distribution.core.internal.StreamProcessorService} - Siddhi App MonitorApp deployed successfully
[2019-04-20 03:59:03,093]  INFO {org.wso2.carbon.kernel.internal.CarbonStartupHandler} - Siddhi Runner Distribution started in 5.941 sec
[2019-04-20 04:04:02,216]  INFO {org.wso2.extension.siddhi.io.http.source.HttpSourceListener} - Event input has paused for http://0.0.0.0:8280/example
[2019-04-20 04:04:02,235]  INFO {org.wso2.extension.siddhi.io.http.source.HttpSourceListener} - Event input has resume for http://0.0.0.0:8280/example
[2019-04-20 04:05:29,741]  INFO {io.siddhi.core.stream.output.sink.LogSink} - LOGGER : Event{timestamp=1555733129736, data=[monitored, 001, 341], isExpired=false}
</pre></div>


<h4 id="deploy-and-run-siddhi-app-using-config-maps">Deploy and Run Siddhi App using config maps<a class="headerlink" href="#deploy-and-run-siddhi-app-using-config-maps" title="Permanent link">&para;</a></h4>
<p>Siddhi operator allows you to deploy Siddhi app configurations via config maps instead of just adding them inline. Through this you can also run multiple Siddhi Apps in a single SiddhiProcess. </p>
<p>This can be done by passing the config maps containing Siddhi app files to the SiddhiProcess's apps configuration as follows. </p>
<div class="codehilite"><pre><span></span>apps:
  - config-map-name1
  - config-map-name2
</pre></div>


<p><strong><em>Sample on deploying and running Siddhi Apps via config maps</em></strong></p>
<p>Here we will creating a very simple Siddhi application as follows, that consumes events via HTTP, filers the input events on type 'monitored' and logs the output on the console.</p>
<script src="https://gist.github.com/BuddhiWathsala/8687a2b73bb003a8ae7bcf3d3f63b78e.js"></script>

<div class="admonition tip">
<p class="admonition-title">Siddhi Tooling</p>
<p>You can also use the powerful <a href="https://siddhi-io.github.io/siddhi/documentation/siddhi-5.x/quckstart-5.x/#3-using-siddhi-for-the-first-time">Siddhi Editor</a> to implement and test steam processing applications. </p>
</div>
<p>Save the above Siddhi App file as <code>MonitorApp.siddhi</code>, and use this file to create a Kubernetes config map with the name <code>monitor-app-cm</code>.
This can be achieved by running the following command. </p>
<div class="codehilite"><pre><span></span>kubectl create configmap monitor-app-cm --from-file=&lt;absolute-file-path&gt;/MonitorApp.siddhi
</pre></div>


<p>The created config map can be added to SiddhiProcess YAML under the <code>apps</code> entry as follows. </p>
<script src="https://gist.github.com/BuddhiWathsala/45019cf093226e4858c931e62e04233f.js"></script>

<p>Save the YAML file as <code>monitor-app.yaml</code>, and use the following command to deploy the SiddhiProcess.</p>
<div class="codehilite"><pre><span></span>kubectl create -f &lt;absolute-yaml-file-path&gt;/monitor-app.yaml
</pre></div>


<div class="admonition note">
<p class="admonition-title">Using a config, created from a directory containing multiple Siddhi files</p>
<p>SiddhiProcess's <code>apps</code> configuration also supports a config map that is created from a directory containing multiple Siddhi files.
Use <code>kubectl create configmap siddhi-apps --from-file=&lt;DIRECTORY_PATH&gt;</code> command to create a config map from a directory.</p>
</div>
<p><em>Invoke Siddhi Applications</em></p>
<p>To invoke the Siddhi Apps, first obtain the external IP of the ingress load balancer using <code>kubectl get ingress</code> command as follows.</p>
<div class="codehilite"><pre><span></span>$ kubectl get ingress
NAME      HOSTS     ADDRESS     PORTS     AGE
siddhi    siddhi    10.0.2.15   80, 443   1m
</pre></div>


<p>Then, add the host <code>siddhi</code> and related external IP (<code>ADDRESS</code>) to the <code>/etc/hosts</code> file in your machine.</p>
<div class="admonition note">
<p class="admonition-title">Minikube</p>
<p>For Minikube, you have to use Minikube IP as the external IP. Hence, run <code>minikube ip</code> command to get the IP of the Minikube cluster.</p>
</div>
<p>Use the following CURL command to send events to <code>monitor-app</code> deployed in Kubernetes.</p>
<div class="codehilite"><pre><span></span>curl -X POST \
  https://siddhi/monitor-app/8280/example \
  -H &#39;Content-Type: application/json&#39; \
  -d &#39;{
    &quot;type&quot;: &quot;monitored&quot;,
    &quot;deviceID&quot;: &quot;001&quot;,
    &quot;power&quot;: 341
    }&#39; -k
</pre></div>


<p><em>Note: Here <code>-k</code> option is used to turn off curl's verification of the certificate.</em> </p>
<p><em>View Siddhi Process Logs</em></p>
<p>Since the output of <code>monitor-app</code> is logged, you can see the output by monitoring the associated pod's logs. </p>
<p>To find the <code>monitor-app</code> pod use the <code>kubectl get pods</code> command. This will list down all the deployed pods. </p>
<div class="codehilite"><pre><span></span>$ kubectl get pods

NAME                               READY     STATUS    RESTARTS   AGE
monitor-app-7f8584875f-krz6t       1/1       Running   0          2m
siddhi-operator-8589c4fc69-6xbtx   1/1       Running   0          2m
siddhi-parser-64d4cd86ff-pfq2s     1/1       Running   0          2m
</pre></div>


<p>Here, the pod starting with the SiddhiProcess name (in this case <code>monitor-app-</code>) is the pod we need to monitor.</p>
<p>To view the logs, run the <code>kubectl logs &lt;pod name&gt;</code> command. 
This will show all the Siddhi process logs, along with the filtered output events as given below.</p>
<div class="codehilite"><pre><span></span>$ kubectl logs monitor-app-7f8584875f-krz6t
[2019-04-20 04:04:02,216]  INFO {org.wso2.extension.siddhi.io.http.source.HttpSourceListener} - Event input has paused for http://0.0.0.0:8280/example
[2019-04-20 04:04:02,235]  INFO {org.wso2.extension.siddhi.io.http.source.HttpSourceListener} - Event input has resume for http://0.0.0.0:8280/example
[2019-04-20 04:05:29,741]  INFO {io.siddhi.core.stream.output.sink.LogSink} - LOGGER : Event{timestamp=1555733129736, data=[monitored, 001, 341], isExpired=false}
</pre></div>


<h4 id="deploy-siddhi-apps-without-ingress-creation">Deploy Siddhi Apps without ingress creation<a class="headerlink" href="#deploy-siddhi-apps-without-ingress-creation" title="Permanent link">&para;</a></h4>
<p>By default, Siddhi operator creates an NGINX ingress and exposes your HTTP/HTTPS through that ingress. If you need to disable automatic ingress creation, you have to change the <code>AUTO_INGRESS_CREATION</code> value in the Siddhi <code>operator.yaml</code> file to <code>false</code> or <code>null</code> as below.</p>
<script src="https://gist.github.com/BuddhiWathsala/c1cadcf9828cfaf46bb909f30497e4ab.js"></script>

<h4 id="deploy-and-run-siddhi-app-with-https">Deploy and Run Siddhi App with HTTPS<a class="headerlink" href="#deploy-and-run-siddhi-app-with-https" title="Permanent link">&para;</a></h4>
<p>Configuring tls will allow Siddhi ingress NGINX to expose HTTPS endpoints of your Siddhi Apps. To do so, created a Kubernetes secret and add that to the SiddhiProcess's <code>tls</code> configuration as following. </p>
<div class="codehilite"><pre><span></span>tls:
  ingressSecret: siddhi-tls
</pre></div>


<p><strong><em>Sample on deploying and running Siddhi App with HTTPS</em></strong></p>
<p>First, you need to create a certificate using the following commands. For more details about the certificate creation refers <a href="https://github.com/kubernetes/ingress-nginx/blob/master/docs/user-guide/tls.md#tls-secrets">this</a>.</p>
<div class="codehilite"><pre><span></span>openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout siddhi.key -out siddhi.crt -subj &quot;/CN=siddhi/O=siddhi&quot;
</pre></div>


<p>After that, create a kubernetes secret called <code>siddhi-tls</code>, which we intended to add to the TLS configurations using the following command.</p>
<div class="codehilite"><pre><span></span>kubectl create secret tls siddhi-tls --key siddhi.key --cert siddhi.crt
</pre></div>


<p>The created secret then need to be added to the created SiddhiProcess's <code>tls</code> configuration as following. </p>
<script src="https://gist.github.com/BuddhiWathsala/f029d671f4f6d7719dce59500b970815.js"></script>

<p>When this is done Siddhi operator will now enable TLS support via the NGINX ingress, and you will be able to access all the HTTPS endpoints.</p>
<p><em>Invoke Siddhi Applications</em></p>
<p>You can use now send the events to following HTTPS endpoint.</p>
<div class="codehilite"><pre><span></span>https://siddhi/monitor-app/8280/example 
</pre></div>


<p>Further, you can use the following CURL command to send a request to the deployed siddhi applications via HTTPS.</p>
<div class="codehilite"><pre><span></span>curl --cacert siddhi.crt -X POST \
  https://siddhi/monitor-app/8280/example \
  -H &#39;Content-Type: application/json&#39; \
  -d &#39;{
    &quot;type&quot;: &quot;monitored&quot;,
    &quot;deviceID&quot;: &quot;001&quot;,
    &quot;power&quot;: 341
    }&#39;
</pre></div>


<p>The output logs show the event that you sent using the previous CURL command.</p>
<div class="codehilite"><pre><span></span>$ kubectl get pods

NAME                               READY     STATUS    RESTARTS   AGE
monitor-app-667c97c898-rrtfs       1/1       Running   0          2m
siddhi-operator-79dcc45959-fkk4d   1/1       Running   0          3m
siddhi-parser-64d4cd86ff-k8b87     1/1       Running   0          3m

$ kubectl logs monitor-app-667c97c898-rrtfs

JAVA_HOME environment variable is set to /opt/java/openjdk
CARBON_HOME environment variable is set to /home/siddhi_user/siddhi-runner-0.1.0
RUNTIME_HOME environment variable is set to /home/siddhi_user/siddhi-runner-0.1.0/wso2/runner
Picked up JAVA_TOOL_OPTIONS: -XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap
[2019-05-06 5:36:54,894]  INFO {org.wso2.carbon.launcher.extensions.OSGiLibBundleDeployerUtils updateOSGiLib} - Successfully updated the OSGi bundle information of Carbon Runtime: runner  
osgi&gt; [2019-05-06 05:36:57,692]  INFO {org.wso2.msf4j.internal.websocket.WebSocketServerSC} - All required capabilities are available of WebSocket service component is available.
[2019-05-06 05:36:57,749]  INFO {org.wso2.carbon.metrics.core.config.model.JmxReporterConfig} - Creating JMX reporter for Metrics with domain &#39;org.wso2.carbon.metrics&#39;
[2019-05-06 05:36:57,779]  INFO {org.wso2.msf4j.analytics.metrics.MetricsComponent} - Metrics Component is activated
[2019-05-06 05:36:57,784]  INFO {org.wso2.carbon.databridge.agent.internal.DataAgentDS} - Successfully deployed Agent Server 
[2019-05-06 05:36:58,292]  INFO {io.siddhi.distribution.event.simulator.core.service.CSVFileDeployer} - CSV file deployer initiated.
[2019-05-06 05:36:58,295]  INFO {io.siddhi.distribution.event.simulator.core.service.SimulationConfigDeployer} - Simulation config deployer initiated.
[2019-05-06 05:36:58,331]  INFO {org.wso2.carbon.databridge.receiver.binary.internal.BinaryDataReceiverServiceComponent} - org.wso2.carbon.databridge.receiver.binary.internal.Service Component is activated
[2019-05-06 05:36:58,342]  INFO {org.wso2.carbon.databridge.receiver.binary.internal.BinaryDataReceiver} - Started Binary SSL Transport on port : 9712
[2019-05-06 05:36:58,343]  INFO {org.wso2.carbon.databridge.receiver.binary.internal.BinaryDataReceiver} - Started Binary TCP Transport on port : 9612
[2019-05-06 05:36:58,343]  INFO {org.wso2.carbon.databridge.receiver.thrift.internal.ThriftDataReceiverDS} - Service Component is activated
[2019-05-06 05:36:58,360]  INFO {org.wso2.carbon.databridge.receiver.thrift.ThriftDataReceiver} - Thrift Server started at 0.0.0.0
[2019-05-06 05:36:58,369]  INFO {org.wso2.carbon.databridge.receiver.thrift.ThriftDataReceiver} - Thrift SSL port : 7711
[2019-05-06 05:36:58,371]  INFO {org.wso2.carbon.databridge.receiver.thrift.ThriftDataReceiver} - Thrift port : 7611
[2019-05-06 05:36:58,466]  INFO {org.wso2.msf4j.internal.MicroservicesServerSC} - All microservices are available
[2019-05-06 05:36:58,567]  INFO {org.wso2.transport.http.netty.contractimpl.listener.ServerConnectorBootstrap$HttpServerConnector} - HTTP(S) Interface starting on host 0.0.0.0 and port 9090
[2019-05-06 05:36:58,574]  INFO {org.wso2.transport.http.netty.contractimpl.listener.ServerConnectorBootstrap$HttpServerConnector} - HTTP(S) Interface starting on host 0.0.0.0 and port 9443
[2019-05-06 05:36:59,091]  INFO {org.wso2.transport.http.netty.contractimpl.listener.ServerConnectorBootstrap$HttpServerConnector} - HTTP(S) Interface starting on host 0.0.0.0 and port 8280
[2019-05-06 05:36:59,092]  INFO {org.wso2.extension.siddhi.io.http.source.HttpConnectorPortBindingListener} - HTTP source 0.0.0.0:8280 has been started
[2019-05-06 05:36:59,093]  INFO {io.siddhi.distribution.core.internal.StreamProcessorService} - Siddhi App MonitorApp deployed successfully
[2019-05-06 05:36:59,100]  INFO {org.wso2.carbon.kernel.internal.CarbonStartupHandler} - Siddhi Runner Distribution started in 4.710 sec
[2019-05-06 05:39:33,804]  INFO {io.siddhi.core.stream.output.sink.LogSink} - LOGGER : Event{timestamp=1557121173802, data=[monitored, 001, 341], isExpired=false}
</pre></div>


<h3 id="using-siddhi-as-a-python-library"><strong>Using Siddhi as a Python Library</strong><a class="headerlink" href="#using-siddhi-as-a-python-library" title="Permanent link">&para;</a></h3>
<p>WIP</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../quckstart-5.x/" title="Quick Start Guide" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Quick Start Guide
              </span>
            </div>
          </a>
        
        
          <a href="../config-guide-5.x/" title="Config Guide" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Config Guide
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2011 - 2019 WSO2
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/siddhi-io/siddhi" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://www.linkedin.com/groups/13553064" class="md-footer-social__link fa fa-linkedin"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.59145f40.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
    
  </body>
</html>